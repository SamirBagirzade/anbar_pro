{% load i18n %}
<!doctype html>
<html lang="{{ LANGUAGE_CODE }}">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% block title %}WMS{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;500;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/htmx.org@1.9.12"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/az.js"></script>
    <style>
      :root { --surface: #ffffff; --ink: #161616; --muted: #6c757d; --accent: #0b5ed7; }
      body { font-family: "Manrope", system-ui, -apple-system, sans-serif; color: var(--ink); background: linear-gradient(180deg, #f8fafc 0%, #eef2f7 100%); }
      .table-dense td, .table-dense th { padding: 0.35rem 0.5rem; font-size: 0.9rem; }
      .sidebar { background: #0f172a; min-height: calc(100vh - 56px); color: #cbd5f5; }
      .sidebar-link { text-decoration: none; display: block; padding: 0.5rem 0.75rem; color: #cbd5f5; border-radius: 0.35rem; }
      .sidebar-link:hover { background: rgba(255,255,255,0.08); color: #fff; }
      .sidebar-title { font-size: 0.75rem; letter-spacing: 0.08em; text-transform: uppercase; color: #94a3b8; }
      .card { border: 0; box-shadow: 0 10px 30px rgba(15, 23, 42, 0.08); }
      form p { margin-bottom: 0.75rem; }
      form input, form select, form textarea { width: 100%; padding: 0.4rem 0.6rem; border: 1px solid #d0d7de; border-radius: 0.35rem; }
      .table thead th { position: sticky; top: 0; background: #f8fafc; }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <div class="container-fluid">
        <a class="navbar-brand" href="/">{% trans "WMS" %}</a>
        <div class="d-flex">
          <form action="{% url 'set_language' %}" method="post" class="me-3">
            {% csrf_token %}
            <input name="next" type="hidden" value="{{ request.path }}">
            <select name="language" class="form-select form-select-sm" onchange="this.form.submit()">
              {% get_current_language as LANGUAGE_CODE %}
              {% get_available_languages as LANGUAGES %}
              {% for lang in LANGUAGES %}
                <option value="{{ lang.0 }}" {% if lang.0 == LANGUAGE_CODE %}selected{% endif %}>{{ lang.1 }}</option>
              {% endfor %}
            </select>
          </form>
          <span class="navbar-text text-white me-3">{{ request.user.username }}</span>
          <form action="{% url 'logout' %}" method="post" class="d-inline">
            {% csrf_token %}
            <button type="submit" class="btn btn-sm btn-outline-light">{% trans "Logout" %}</button>
          </form>
        </div>
      </div>
    </nav>
    <div class="container-fluid">
      <div class="row">
        <aside class="col-md-2 sidebar pt-3">
          <a class="sidebar-link" href="{% url 'warehouse_stock' %}">{% trans "Warehouse Stock" %}</a>
          <a class="sidebar-link" href="{% url 'recent_movements' %}">{% trans "Recent Movements" %}</a>
          <a class="sidebar-link" href="{% url 'vendor_stock_detail' %}">{% trans "Vendor Stock Detail" %}</a>
          <div class="mt-3 sidebar-title">{% trans "Masters" %}</div>
          <a class="sidebar-link" href="{% url 'vendor_list' %}">{% trans "Vendors" %}</a>
          <a class="sidebar-link" href="{% url 'warehouse_list' %}">{% trans "Warehouses" %}</a>
          <a class="sidebar-link" href="{% url 'outgoing_location_list' %}">{% trans "Outgoing Locations" %}</a>
          <a class="sidebar-link" href="{% url 'item_list' %}">{% trans "Items" %}</a>
          <div class="mt-3 sidebar-title">{% trans "Transactions" %}</div>
          <a class="sidebar-link" href="{% url 'purchase_create' %}">{% trans "New Purchase" %}</a>
          <a class="sidebar-link" href="{% url 'issue_create' %}">{% trans "New Issue" %}</a>
        </aside>
        <main class="col-md-10 pt-4">
          {% if messages %}
            {% for message in messages %}
              <div class="alert alert-info">{{ message }}</div>
            {% endfor %}
          {% endif %}
          {% block content %}{% endblock %}
        </main>
      </div>
    </div>
  </body>
  <script>
    (function() {
      if (!window.flatpickr) return;
      document.querySelectorAll('[data-date-picker]').forEach(function(input) {
        window.flatpickr(input, {
          dateFormat: "d/m/Y",
          allowInput: true,
          locale: window.flatpickr.l10ns.az || undefined,
        });
      });
    })();
  </script>
</html>
